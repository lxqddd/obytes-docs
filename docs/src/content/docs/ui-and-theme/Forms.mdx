---
title: 表单
description: 如何使用 react-hook-form 和受控组件处理表单。
head:
  - tag: title
    content: 表单 | React Native / Expo Starter
---

import CodeBlock from '../../../components/code.astro';

表单是任何应用程序的常见功能。在本节中，我们将向您展示如何使用启动器正确处理表单。

## react-hook-form

启动器使用 [react-hook-form](https://react-hook-form.com/) 来处理表单。这是一个流行的库，开箱即用提供了很多功能。它也非常易于使用并与 React Native 集成。

请务必查看 [react-hook-form 文档](https://react-hook-form.com/) 以了解更多使用方法。

正如我们在文档的组件部分 [此处](../components/) 中提到的，我们创建了一组仅与 react-hook-form 一起使用的受控组件。启动器仅提供两个组件：`ControlledInput` 和 `ControlledSelect`，但您可以使用相同的方法轻松创建其他组件。

以下是我们使用 react-hook-form 的 `useController` 钩子来处理表单状态和验证规则时的 `ControlledInput` 完整代码：

<CodeBlock file="src/components/ui/input.tsx" />

如果您想创建自己的受控组件，只需要确保您的组件属性类型以与 `ControlledInput` 相同的方式扩展自 `InputControllerType`。
以下是我们使用与 `ControlledInput` 相同方法创建的选择输入组件的另一个示例：

<CodeBlock file="src/components/ui/select.tsx" />

## 使用案例

假设您想要创建一个允许用户登录应用程序的表单。您需要创建一个包含表单的屏幕，该表单具有电子邮件和密码字段，以及一个提交按钮。表单需要进行验证，数据需要发送到后端。以下是您可以如何实现的方法：

**步骤 1：创建您的架构验证 **

验证表单的正确方法是创建架构验证。您可以使用任何您想要的库，但我们推荐使用 zod，因为您可以轻松地从架构推断类型。以下是如何为登录表单创建架构验证的方法：

```tsx
import * as z from 'zod';

const schema = z.object({
  email: z.string().email(),
  password: z.string().min(6),
});

type FormType = z.infer<typeof schema>;
```

**步骤 2：创建您的表单组件**

现在您有了架构验证，您可以轻松地使用 react-hook-form 和我们已有的受控组件创建您的登录屏幕。
以下是如何创建您的登录屏幕的方法：

```tsx
import { zodResolver } from '@hookform/resolvers/zod';
import React from 'react';
import { useForm } from 'react-hook-form';
import * as z from 'zod';

import { useAuth } from '@/lib';
import { Button, ControlledInput, View } from '@/components/ui';

const schema = z.object({
  email: z.string().email(),
  password: z.string().min(6),
});

type FormType = z.infer<typeof schema>;

export const Login = () => {
  const { signIn } = useAuth();

  const { handleSubmit, control } = useForm<FormType>({
    resolver: zodResolver(schema),
  });

  const onSubmit = (data: FormType) => {
    console.log(data);
    signIn({ access: 'access-token', refresh: 'refresh-token' });
  };
  return (
    <View className="flex-1 justify-center p-4">
      <ControlledInput control={control} name="email" label="Email" />
      <ControlledInput
        control={control}
        name="password"
        label="Password"
        placeholder="***"
        secureTextEntry={true}
      />
      <Button
        label="Login"
        onPress={handleSubmit(onSubmit)}
        variant="primary"
      />
    </View>
  );
};
```

完成！您已经创建了一个带有验证和 TypeScript 支持的表单。

:::tip
任何属性继承自 `InputControllerType` 的组件都可以与 react-hook-form 一起使用。您可以使用与 `ControlledInput` 和 `ControlledSelect` 相同的方法轻松创建自己的受控组件。
:::

## 处理键盘

模板预装并配置了 [`react-native-keyboard-controller`](https://kirillzyusko.github.io/react-native-keyboard-controller/) 来处理键盘。您只需要查看 [文档](https://kirillzyusko.github.io/react-native-keyboard-controller/) 并为您的用例使用适当的方法。（请注意，我们已经在根文件中的布局里添加了 `KeyboardProvider`）

请务必查看以下视频以了解更多关于如何在 React Native 中处理键盘的详细信息：

<div class="embed-container">
  <iframe
    src="https://www.youtube.com/embed/Y51mDfAhd4E?si=8uPml61z0R1hsZGy&amp;start=1139"
    frameborder="0"
    allowfullscreen
  ></iframe>
</div>
