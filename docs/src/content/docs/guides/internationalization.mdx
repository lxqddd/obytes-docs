---
title: 国际化
description: 如何为应用添加国际化支持。
head:
  - tag: title
    content: 国际化 | React Native / Expo Starter
---

import CodeBlock from '../../../components/code.astro';

该模板附带了基本的国际化设置。它使用 [expo-localization](https://docs.expo.dev/guides/localization/) 和 [i18next](https://www.i18next.com/) 来提供一种简单的方式为您的应用添加翻译功能。

## 添加新语言

演示应用主要支持两种语言：英语和阿拉伯语（RTL）。您可以通过在 `src/translations` 文件夹中添加翻译文件，并在 `src/lib/i18n/resources.ts` 文件中添加语言代码来添加更多语言。

<CodeBlock file="src/lib/i18n/resources.ts" />

:::tip
任何与国际化相关的内容都可以在 `src/lib/i18n` 文件夹中找到。
:::

## 在应用中使用翻译

i18n 核心模块提供了一组实用函数来帮助您在应用中使用翻译。

- 来自 `react-i18next` 的 `useTranslation` 钩子：用于获取翻译函数。

```tsx
import React from 'react';
import { useTranslation } from 'react-i18next';

import { Text } from '@/components/ui';

export const Foo = () => {
  const { t } = useTranslation();
  return (
    <>
      <Text className="text-center">{t('settings.language')}</Text>
    </>
  );
};
```

或者由于 `Text` 组件内置了翻译支持，您可以轻松地按以下方式使用：

```tsx
import React from 'react';

import { Text } from '@/components/ui';

export const Foo = () => {
  return <Text className="text-center" tx="settings.language" />;
};
```

- `useSetLanguage` 钩子：用于更改当前语言。该钩子返回选定的语言和一个用于更改语言的函数。

此外，`useSetLanguage` 钩子将使用 `MMKV` 将选定的语言保存在设备存储中，并在重新打开应用时作为默认语言使用，同时在更新选定语言时为 RTL 语言添加一些额外配置。

<CodeBlock file="src/lib/i18n/utils.tsx" />

## 健壮的翻译

**TypeScript 支持**

为了使应用的翻译更加健壮和易于维护，我们为翻译函数添加了 TypeScript 支持。这确保您使用正确的翻译键，并为翻译键提供自动补全功能。
以下是使用错误翻译键时会出现的错误示例。

![typescript-translation](https://github.com/obytes/react-native-template-obytes/assets/11137944/80a7a0fd-a6f8-4d31-a450-46de797ebdc6)

## ESLint 规则

我们还添加了 ESLint 规则来确保您的翻译文件资源始终保持最新。这些规则会在您尝试提交翻译文件更改时作为预提交钩子运行。

我们使用 [eslint-plugin-i18n-json](https://github.com/godaddy/eslint-plugin-i18n-json) 配合自定义的 i18next 验证脚本。该脚本帮助排序键，确保所有资源文件都相同，并防止任何缺失的翻译。
